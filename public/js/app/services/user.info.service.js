"use strict";
var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var __metadata = (this && this.__metadata) || function (k, v) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);
};
/**
 * Created by Thisum on 8/17/2016.
 */
var core_1 = require("@angular/core");
var http_1 = require("@angular/http");
var constants_1 = require("../util/constants");
var PaymentSchema_1 = require("../obj/PaymentSchema");
var request_builder_util_1 = require("../util/request-builder.util");
var UserInfoService = (function () {
    function UserInfoService(_http) {
        this._http = _http;
        this.baseUrl = constants_1.BASE_URL + '/admin';
    }
    UserInfoService.prototype.loadPaymentSchema = function () {
        var headers = request_builder_util_1.getHeader();
        var url = this.baseUrl + '/getschema';
        return this._http.get(url, { headers: headers, body: {} }).toPromise()
            .then(function (response) {
            var status = response.json().status;
            if (status == constants_1.SERVER_RESPONSE_STATUS.SUCCESS) {
                var data = response.json().result;
                var objs = [];
                for (var i = 0; i < data.length; i++) {
                    var schema = new PaymentSchema_1.PaymentSchema(data[i].service, data[i].type, data[i].name);
                    objs.push(schema);
                }
                return objs;
            }
            else if (status == constants_1.SERVER_RESPONSE_STATUS.FAILED) {
                throw new Error(response.json().message);
            }
        })
            .catch(this.handleError);
    };
    UserInfoService.prototype.addPaymentSchema = function (schema) {
        var headers = request_builder_util_1.getHeader();
        var url = this.baseUrl + '/addschema';
        return this._http.post(url, schema, { headers: headers }).toPromise()
            .then(function (response) {
            var obj = response.json();
            if (obj.status == constants_1.SERVER_RESPONSE_STATUS.SUCCESS) {
                var schema_1 = new PaymentSchema_1.PaymentSchema(obj.result.service, obj.result.type, obj.result.name);
                return schema_1;
            }
            else if (obj.status == constants_1.SERVER_RESPONSE_STATUS.FAILED) {
                throw new Error(response.json().message);
            }
        })
            .catch(this.handleError);
    };
    UserInfoService.prototype.deleteSchema = function (ps) {
    };
    UserInfoService.prototype.editSchema = function (ps) {
    };
    UserInfoService.prototype.getServiceDetails = function () {
        var headers = request_builder_util_1.getHeader();
        var url = this.baseUrl + '/getservices';
        return this._http.get(url, { headers: headers, body: {} }).toPromise()
            .then(function (response) {
            var status = response.json().status;
            if (status == constants_1.SERVER_RESPONSE_STATUS.SUCCESS) {
                return response.json().result;
            }
            else if (status == constants_1.SERVER_RESPONSE_STATUS.FAILED) {
                throw new Error(response.json().message);
            }
        })
            .catch(this.handleError);
    };
    UserInfoService.prototype.handleError = function (error) {
        console.error('Error occurred : ' + error);
        return Promise.reject(error.message || error);
    };
    UserInfoService = __decorate([
        core_1.Injectable(), 
        __metadata('design:paramtypes', [http_1.Http])
    ], UserInfoService);
    return UserInfoService;
}());
exports.UserInfoService = UserInfoService;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2VzL3VzZXIuaW5mby5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTs7R0FFRztBQUNILHFCQUF5QixlQUFlLENBQUMsQ0FBQTtBQUN6QyxxQkFBNEIsZUFBZSxDQUFDLENBQUE7QUFFNUMsMEJBQStDLG1CQUFtQixDQUFDLENBQUE7QUFDbkUsOEJBQTRCLHNCQUFzQixDQUFDLENBQUE7QUFDbkQscUNBQXdCLDhCQUE4QixDQUFDLENBQUE7QUFJdkQ7SUFJSSx5QkFBcUIsS0FBVztRQUFYLFVBQUssR0FBTCxLQUFLLENBQU07UUFGeEIsWUFBTyxHQUFHLG9CQUFRLEdBQUcsUUFBUSxDQUFDO0lBSXRDLENBQUM7SUFFTSwyQ0FBaUIsR0FBeEI7UUFFSSxJQUFNLE9BQU8sR0FBRyxnQ0FBUyxFQUFFLENBQUM7UUFDNUIsSUFBSSxHQUFHLEdBQUcsSUFBSSxDQUFDLE9BQU8sR0FBRyxZQUFZLENBQUM7UUFFdEMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFFLEdBQUcsRUFBRyxFQUFDLE9BQU8sRUFBRyxPQUFPLEVBQUUsSUFBSSxFQUFHLEVBQUUsRUFBQyxDQUFDLENBQUMsU0FBUyxFQUFFO2FBQ25FLElBQUksQ0FBQyxVQUFBLFFBQVE7WUFDVixJQUFNLE1BQU0sR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDO1lBQ3RDLEVBQUUsQ0FBQSxDQUFDLE1BQU0sSUFBSSxrQ0FBc0IsQ0FBQyxPQUFPLENBQUMsQ0FDNUMsQ0FBQztnQkFDRyxJQUFNLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDO2dCQUNwQyxJQUFJLElBQUksR0FBVSxFQUFFLENBQUM7Z0JBQ3JCLEdBQUcsQ0FBQSxDQUFDLElBQUksQ0FBQyxHQUFDLENBQUMsRUFBRSxDQUFDLEdBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQUUsRUFBQyxDQUFDO29C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Q2pELENBQUM7Z0JBQ0csTUFBTSxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsT0FBTyxDQUFDLENBQUM7WUFDN0MsQ0FBQztRQUNMLENBQUMsQ0FBQzthQUNELEtBQUssQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUdPLHFDQUFXLEdBQW5CLFVBQW9CLEtBQVU7UUFDMUIsT0FBTyxDQUFDLEtBQUssQ0FBQyxtQkFBbUIsR0FBRSxLQUFLLENBQUUsQ0FBQztRQUMzQyxNQUFNLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxJQUFJLEtBQUssQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUF6Rkw7UUFBQyxpQkFBVSxFQUFFOzt1QkFBQTtJQTJGYixzQkFBQztBQUFELENBMUZBLEFBMEZDLElBQUE7QUExRlksdUJBQWUsa0JBMEYzQixDQUFBIiwiZmlsZSI6InNlcnZpY2VzL3VzZXIuaW5mby5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgVGhpc3VtIG9uIDgvMTcvMjAxNi5cclxuICovXHJcbmltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcclxuaW1wb3J0IHtIdHRwLCBIZWFkZXJzfSBmcm9tIFwiQGFuZ3VsYXIvaHR0cFwiO1xyXG5cclxuaW1wb3J0IHtTRVJWRVJfUkVTUE9OU0VfU1RBVFVTLCBCQVNFX1VSTH0gZnJvbSBcIi4uL3V0aWwvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7UGF5bWVudFNjaGVtYX0gZnJvbSBcIi4uL29iai9QYXltZW50U2NoZW1hXCI7XHJcbmltcG9ydCB7Z2V0SGVhZGVyfSBmcm9tIFwiLi4vdXRpbC9yZXF1ZXN0LWJ1aWxkZXIudXRpbFwiO1xyXG5cclxuXHJcbkBJbmplY3RhYmxlKClcclxuZXhwb3J0IGNsYXNzIFVzZXJJbmZvU2VydmljZXtcclxuXHJcbiAgICBwcml2YXRlIGJhc2VVcmwgPSBCQVNFX1VSTCArICcvYWRtaW4nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yIChwcml2YXRlIF9odHRwOiBIdHRwKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBsb2FkUGF5bWVudFNjaGVtYSgpOiBQcm9taXNlPFBheW1lbnRTY2hlbWFbXT57XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSBnZXRIZWFkZXIoKTtcclxuICAgICAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsICsgJy9nZXRzY2hlbWEnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCggdXJsICwge2hlYWRlcnMgOiBoZWFkZXJzLCBib2R5IDoge319KS50b1Byb21pc2UoKVxyXG4gICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdGF0dXMgPSByZXNwb25zZS5qc29uKCkuc3RhdHVzO1xyXG4gICAgICAgICAgICAgICAgaWYoc3RhdHVzID09IFNFUlZFUl9SRVNQT05TRV9TVEFUVVMuU1VDQ0VTUylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuanNvbigpLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgb2JqczogYW55W10gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IobGV0IGk9MDsgaTxkYXRhLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNjaGVtYSA9IG5ldyBQYXltZW50U2NoZW1hKGRhdGFbaV0uc2VydmljZSwgZGF0YVtpXS50eXBlLCBkYXRhW2ldLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpzLnB1c2goc2NoZW1hKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9ianM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKCBzdGF0dXMgPT0gU0VSVkVSX1JFU1BPTlNFX1NUQVRVUy5GQUlMRUQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3BvbnNlLmpzb24oKS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKHRoaXMuaGFuZGxlRXJyb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhZGRQYXltZW50U2NoZW1hKHNjaGVtYTogUGF5bWVudFNjaGVtYSk6IFByb21pc2U8UGF5bWVudFNjaGVtYT57XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSBnZXRIZWFkZXIoKTtcclxuICAgICAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsICsgJy9hZGRzY2hlbWEnO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5faHR0cC5wb3N0KCB1cmwsIHNjaGVtYSwge2hlYWRlcnMgOiBoZWFkZXJzfSkudG9Qcm9taXNlKClcclxuICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqID0gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgaWYob2JqLnN0YXR1cyA9PSBTRVJWRVJfUkVTUE9OU0VfU1RBVFVTLlNVQ0NFU1MpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNjaGVtYSA9IG5ldyBQYXltZW50U2NoZW1hKG9iai5yZXN1bHQuc2VydmljZSwgb2JqLnJlc3VsdC50eXBlLCBvYmoucmVzdWx0Lm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzY2hlbWE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKCBvYmouc3RhdHVzID09IFNFUlZFUl9SRVNQT05TRV9TVEFUVVMuRkFJTEVEKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihyZXNwb25zZS5qc29uKCkubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRsZUVycm9yKTtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVsZXRlU2NoZW1hKHBzOiBQYXltZW50U2NoZW1hKXtcclxuXHJcbiAgICB9XHJcbiAgICBcclxuICAgIHB1YmxpYyBlZGl0U2NoZW1hKHBzOiBQYXltZW50U2NoZW1hKXtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldFNlcnZpY2VEZXRhaWxzKCk6IFByb21pc2U8SlNPTj57XHJcblxyXG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSBnZXRIZWFkZXIoKTtcclxuICAgICAgICB2YXIgdXJsID0gdGhpcy5iYXNlVXJsICsgJy9nZXRzZXJ2aWNlcyc7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9odHRwLmdldCggdXJsLCB7aGVhZGVycyA6IGhlYWRlcnMsIGJvZHkgOiB7fX0pLnRvUHJvbWlzZSgpXHJcbiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJlc3BvbnNlLmpzb24oKS5zdGF0dXM7XHJcbiAgICAgICAgICAgICAgICBpZihzdGF0dXMgPT0gU0VSVkVSX1JFU1BPTlNFX1NUQVRVUy5TVUNDRVNTKVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKS5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmKCBzdGF0dXMgPT0gU0VSVkVSX1JFU1BPTlNFX1NUQVRVUy5GQUlMRUQpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKHJlc3BvbnNlLmpzb24oKS5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKHRoaXMuaGFuZGxlRXJyb3IpO1xyXG4gICAgfVxyXG4gICAgXHJcblxyXG4gICAgcHJpdmF0ZSBoYW5kbGVFcnJvcihlcnJvcjogYW55KXtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvY2N1cnJlZCA6ICcgK2Vycm9yICk7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xyXG4gICAgfVxyXG5cclxufSJdfQ==
